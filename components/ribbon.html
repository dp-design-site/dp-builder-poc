<!-- components/ribbon.html -->
<div id="dp-ribbon" class="dp-ribbon one-line">
  <div class="dp-ribbon-tools" data-tab-content="constraints">
    <div class="group">
      <div class="group-title">Align</div>
      <button class="tool" id="tool-align-vertical" title="Vertical Align (Constraint)">
        <span class="icon">│</span>
        <!--<span>Vertical</span>-->
      </button>
      <button class="tool" id="tool-align-horizontal" title="Horizontal Align (Constraint)">
        <span class="icon">─</span>
        <!--<span>Horizontal</span>-->
      </button>
    </div>
  </div>
</div>

<style>
  .dp-ribbon.one-line { position: fixed; top: 0; left: 0; right: 0; height: 56px; z-index: 10000;
    background: linear-gradient(180deg, #2a3147, #232a3a); border-bottom: 1px solid #1b2234; color: #eaeef7;
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial; display:flex; align-items:center; }
  .dp-ribbon-tools { display: flex; gap: 14px; padding: 8px 12px; }
  .group { display: inline-flex; align-items: center; gap: 8px; background: #21283a; border: 1px solid #2b3450; border-radius: 10px; padding: 6px 8px; }
  .group-title { font-size: 12px; opacity: .85; margin-right: 6px; }
  .tool { display: inline-flex; align-items: center; gap: 6px; height: 36px; padding: 0 10px;
    background: #26304a; border: 1px solid #313a57; border-radius: 8px; cursor: pointer; font-size: 13px; }
  .tool .icon { font-size: 18px; line-height: 1; }
  .tool:hover { background: #2d3856; }
  .tool.active { background: #3a4670; border-color: #4a5b8f; box-shadow: inset 0 0 0 1px rgba(255,255,255,0.06); }
</style>

<script>
(function(){
  function ensureConstraintsAPI(){
    return !!(window.Constraints && typeof window.Constraints.setMode === 'function');
  }
  const btnV = document.getElementById('tool-align-vertical');
  const btnH = document.getElementById('tool-align-horizontal');

  function setActive(mode){
    btnV?.classList.toggle('active', mode === 'alignV');
    btnH?.classList.toggle('active', mode === 'alignH');
  }

  btnV?.addEventListener('click', () => {
    if (!ensureConstraintsAPI()) return;
    const m = window.Constraints.getMode();
    window.Constraints.setMode(m === 'alignV' ? 'none' : 'alignV');
  });
  btnH?.addEventListener('click', () => {
    if (!ensureConstraintsAPI()) return;
    const m = window.Constraints.getMode();
    window.Constraints.setMode(m === 'alignH' ? 'none' : 'alignH');
  });

  // синхронизация при промяна на режима от другаде
  window.addEventListener('constraints:mode', (e)=> setActive(e.detail.mode));
  // начален state
  setTimeout(()=>{ if (ensureConstraintsAPI()) setActive(window.Constraints.getMode()); }, 0);
})();
</script>
